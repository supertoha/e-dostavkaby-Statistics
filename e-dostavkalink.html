<html><head>
<meta charset="utf-8"/>
<style type="text/css">
.draganddrop {
  position: absolute;
  visibility: hidden;
    text-decoration: none;
    color: #007bff;
}
.draganddrop:visited {
text-decoration: none;
}

.draganddrop:before {
  content: "Перетяни меня в закладки";
  visibility: visible;
  font-size: 25px;  
    text-decoration: none;
}

.container {
     position: absolute;
     margin: auto;
     top: 0;
     right: 0;
     bottom: 0;
     left: 0;
     width: 300px;
     height: 300px;
}
  </style></head><body><div class="container"><a class="draganddrop" href='javascript:async function getData(a){return $.ajax({url:a,type:"GET"})}async function getProductInfo(a,b){const c=await getData(a);var d=$(".breadcrumbs",c).children("a").eq(2).text(),e=$(".price meta",c).attr("content");return{url:a,category:d,id:b,price:e}}async function buildMoneyPerMonthChart(a){const b=["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0432\u0440\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"];let c=new Date(-864e13),d=new Date(864e13);for(let b=0;b<a.length;b++)a[b].date>=c&&(c=a[b].date),a[b].date<=d&&(d=a[b].date);var e=c.getMonth()+12*c.getFullYear()-(d.getMonth()+12*d.getFullYear()),f=[];for(let c=0;c<=e;c++){var g=new Date(d.getFullYear(),d.getMonth()+c,1),h=0;for(let b=0;b<a.length;b++)a[b].date.getMonth()===g.getMonth()&&a[b].date.getFullYear()===g.getFullYear()&&(h+=a[b].price);var i=b[g.getMonth()]+" "+g.getFullYear().toString();f.push({label:i,y:h})}$("#chartContainer").CanvasJSChart({animationEnabled:!0,title:{text:"\u0420\u0430\u0441\u0445\u043E\u0434\u044B \u0432 \u043C\u0435\u0441\u044F\u0446"},axisY:{title:"\u0440\u0430\u0441\u0445\u043E\u0434\u044B",suffix:"\u0440",includeZero:!1},axisX:{title:"\u041C\u0435\u0441\u044F\u0446\u044B"},data:[{type:"column",dataPoints:f}]})}function buildPriceChangeChart(a,b){var c=[],d=0;for(const l of b){var e=[],f=-Infinity,g=1/0,h="";for(const b of a)if(l.id===b.id){if(!isNaN(parseFloat(l.price))&&0===e.length){var i=parseFloat(l.price);e.push({y:i,x:new Date})}h=b.title;var j=b.price/b.quantity;e.push({y:j,x:b.date}),j<=g&&(g=j),j>=f&&(f=j)}var k=(f-g)/f;k>=d&&(d=k),c.push({label:h+" \u0430\u0440\u0442. "+l.id,name:h,points:e,priceChangeRate:k})}var l=c.find(a=>a.priceChangeRate===d);$("#productDropDown").autocomplete({source:c,minLength:2,focus:function(){return!1},select:function(a,b){return $("#productDropDown").val(b.item.name),drawPriceChangeChart(b.item.points,b.item.name),!1}}),$("#productDropDown").val(l.name),$("#productDropDown").dblclick(function(){$("#productDropDown").val("")}),drawPriceChangeChart(l.points,l.name)}function drawPriceChangeChart(a,b){$("#priceChangeChartContainer").CanvasJSChart({animationEnabled:!0,theme:"light2",title:{text:"\u0414\u0438\u043D\u0430\u043C\u0438\u043A\u0430 \u0446\u0435\u043D\u044B \u0442\u043E\u0432\u0430\u0440\u0430"},axisX:{valueFormatString:"DD MMM"},axisY:{title:"\u0426\u0435\u043D\u0430 \u0442\u043E\u0432\u0430\u0440\u0430, \u0440",suffix:"\u0440",minimum:0},toolTip:{shared:!0},legend:{cursor:"pointer",verticalAlign:"bottom",horizontalAlign:"left",dockInsidePlotArea:!0},data:[{type:"line",showInLegend:!0,name:b,markerType:"square",xValueFormatString:"DD MMM, YYYY",color:"#F08080",yValueFormatString:"0.00",dataPoints:a}]})}function findCategory(a,b){for(let c=0;c<a.length;c++)if(a[c].url===b)return a[c].category}function buildMoneyPerCategory(a,b){var c=[],d=0;for(let g=0;g<a.length;g++){var e=a[g];if(!isNullOrEmpty(e.url)){var f=findCategory(b,e.url);isNullOrEmpty(f)||("undefined"==typeof c[f]&&(c[f]=0),c[f]+=e.price,d+=e.price)}}var g=[];for(curCategory in c)g.push({label:curCategory,y:(100*c[curCategory]/d).toFixed(2)});$("#chartContainerPie").CanvasJSChart({title:{text:"\u0420\u0430\u0441\u0445\u043E\u0434\u044B \u043F\u043E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F\u043C"},data:[{type:"pie",startAngle:45,showInLegend:"true",legendText:"{label}",indexLabel:"{label} ({y})",yValueFormatString:"0.0",dataPoints:g}]})}function parseDate(a){var b=a.split(" ",3),c=b[0],d=["\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"].indexOf(b[1]),e=b[2];return new Date(e,d,c)}function main(){return"e-dostavka.by"===window.location.hostname?void $(".wrapper").html("<a id=startButton class=ui-button style=font-size:250%;margin:100px;20px; onclick=javascript:buildStat() href=#>\u0421\u043E\u0431\u0440\u0430\u0442\u044C \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0443</a><div id=progresscontainer style=margin:100px;20px;display:none;font-size:14px;><div id=messageBox style=font-size:16px;font-color:#a01919></div><div id=progressbar></div></div><div id=answerContainer style=display:none;><div style=margin:30px;5px;><div id=chartContainer style=height:370px;width:100%;></div></div><div style=margin:30px;5px;><div id=chartContainerPie style=height:370px;width:100%;></div></div><div style=margin:30px;5px;><div style=width:100%;><label for=productDropDown style=min-width:100px;font-size:16px;width:20%;>\u041F\u0440\u043E\u0434\u0443\u043A\u0442: </label><input id=productDropDown style=width:80%;></div><div id=priceChangeChartContainer style=height:370px;width:100%;></div></div></div><script src=https://code.jquery.com/ui/1.12.1/jquery-ui.js></script><script src=https://canvasjs.com/assets/script/jquery.canvasjs.min.js></script>"):void alert("\u0421\u043A\u0440\u0438\u043F\u0442 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442 \u0442\u043E\u043B\u044C\u043A\u043E \u043D\u0430 e-dostavka.by")}function isNullOrEmpty(a){return"undefined"==typeof a||""===a}async function buildStat(){$("#progressbar").progressbar({value:0}),$("#progresscontainer").show(),$("#startButton").hide(),$("#messageBox").html("\u0418\u0434\u0435\u0442 \u0441\u0431\u043E\u0440 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0438, \u044D\u0442\u043E \u043C\u043E\u0436\u0435\u0442 \u0437\u0430\u043D\u044F\u0442\u044C \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u043C\u0438\u043D\u0443\u0442...");var a=[],b=[];const c=await getData("https://e-dostavka.by/cabinet/history/");var d=$(".number a",c),e=d.length;if(0===e)return void $("#messageBox").html("\u041D\u0435\u0442 \u0434\u043E\u0441\u0442\u0443\u043F\u0430 \u043A \u0438\u0441\u0442\u043E\u0440\u0438\u0438 \u0437\u0430\u043A\u0430\u0437\u043E\u0432 \u0438\u043B\u0438 \u0438\u0441\u0442\u043E\u0440\u0438\u044F \u0437\u0430\u043A\u0430\u0437\u043E\u0432 \u043F\u0443\u0441\u0442\u0430.");for(let c=0;c<e;c++){var f=$(d[c]).attr("href");const k=await getData(f);var g=100*c/e;$("#progressbar").progressbar({value:g});var h=0<$(".fa-home",k).length;if(h){var i=$(".date_order",k);i.find("b").remove();var j=parseDate(i.text()),l=$(".description",k);for(let c=0;c<l.length;c++){var m=$(".itog",l[c]);m.find("strong").remove(),m.find("b").remove();var n=$(".cent",m).text();m.find("span").remove();var o=m.text(),p=parseFloat(o)+parseFloat(n)/100,q=$(".title",l[c]),r=q.text(),s=$(".title a",l[c]).attr("href"),t=$(".row-item",l[c]).filter(function(){return"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E:"===$("strong",this).text().trim()});t.find("strong").remove(),t.find("span").remove();var u=parseFloat(t.text()),v=$(".row-item",l[c]).filter(function(){return"\u0410\u0440\u0442\u0438\u043A\u0443\u043B:"===$("strong",this).text().trim()});v.find("strong").remove();var w=v.text().trim();if(0===b.filter(a=>a.id===w).length&&!isNullOrEmpty(s)){const a=await getProductInfo(s,w);b.push(a)}a.push({date:j,title:r,url:s,price:p,quantity:u,id:w})}}}$("#progresscontainer").hide(),$("#answerContainer").show(),buildMoneyPerMonthChart(a,b),buildMoneyPerCategory(a,b),buildPriceChangeChart(a,b)}main();' title="Перетяни меня в закладки">e-dostavka Статистика</a></div></body></html>
